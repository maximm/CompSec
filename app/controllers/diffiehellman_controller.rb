class DiffiehellmanController < ApplicationController
  def index
    @hello = "Hello my dear friend"
  end
  
  def create
    @keyA = params[:a]["key"]
    @keyB = params[:b]["key"]
    
    bigA = 8657546431234234234234342524565263243432143245112378123891238912983712381972319823719823751123781238912389129837123819723198237198237
    bigB = 1965467574231123123451243123423423424234265615112378123891238912983712381972319823719823751123781238912389129837123819723198237198237
    
    g = 5
    x = 51123781238912389129837123819723198237198237511237812389123891298371238197231982371982375112378123891238912983712381972319823719823751123781238912389129837123819723198237198237
    p = 239872319371292131231231231233234534534534532453453453245345
    
    modder = Modmath.new
    # def pow(base, power, mod)
    
    #hint: key = A^x mod p = 8^5 mod 23
    @correctKeyA = modder.pow(bigA,x,p)
    #hint: key = B^x mod p = 19^5 mod 23
    @correctKeyB = modder.pow(bigB,x,p)
  end
end
